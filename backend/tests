# Test File Structure for AI-Powered Expense Tracker

# /ai-powered-expense-tracker/ai-powered-expense-tracker/backend/tests/conftest.py
import pytest
from fastapi.testclient import TestClient
from app.main import app

@pytest.fixture(scope="module")
def test_client():
    client = TestClient(app)
    yield client

# /ai-powered-expense-tracker/ai-powered-expense-tracker/backend/tests/test_auth.py
def test_register(test_client):
    response = test_client.post("/api/v1/auth/register", json={"email": "test@example.com", "password": "password"})
    assert response.status_code == 201
    assert "access_token" in response.json()

def test_login(test_client):
    response = test_client.post("/api/v1/auth/login", json={"email": "test@example.com", "password": "password"})
    assert response.status_code == 200
    assert "access_token" in response.json()

# /ai-powered-expense-tracker/ai-powered-expense-tracker/backend/tests/test_businesses.py
def test_create_business(test_client):
    response = test_client.post("/api/v1/businesses", json={"name": "Test Business"})
    assert response.status_code == 201
    assert response.json()["name"] == "Test Business"

def test_get_business(test_client):
    response = test_client.get("/api/v1/businesses/1")
    assert response.status_code == 200
    assert "name" in response.json()

# /ai-powered-expense-tracker/ai-powered-expense-tracker/backend/tests/test_transactions.py
def test_create_transaction(test_client):
    response = test_client.post("/api/v1/transactions", json={"amount": 100, "category": "Expense"})
    assert response.status_code == 201
    assert response.json()["amount"] == 100

def test_get_transactions(test_client):
    response = test_client.get("/api/v1/transactions")
    assert response.status_code == 200
    assert isinstance(response.json(), list)

# /ai-powered-expense-tracker/ai-powered-expense-tracker/backend/tests/test_documents.py
def test_upload_document(test_client):
    with open("test_document.pdf", "rb") as file:
        response = test_client.post("/api/v1/documents", files={"file": file})
    assert response.status_code == 201
    assert "document_id" in response.json()

# /ai-powered-expense-tracker/ai-powered-expense-tracker/backend/tests/test_rules.py
def test_create_rule(test_client):
    response = test_client.post("/api/v1/rules", json={"name": "Test Rule", "conditions": {}})
    assert response.status_code == 201
    assert response.json()["name"] == "Test Rule"

# /ai-powered-expense-tracker/ai-powered-expense-tracker/backend/tests/test_reports.py
def test_generate_report(test_client):
    response = test_client.post("/api/v1/reports/generate", json={"type": "income_statement"})
    assert response.status_code == 200
    assert "report_url" in response.json()